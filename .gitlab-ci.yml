image: op-gitlab.howest.be:4567/docker-registry/gradle-node:master

stages:
  - build
  - codequality
  - test
  - deploy

before_script:
  - chmod +x gradlew
  - export GRADLE_USER_HOME=/cache/.gradle

cache:
  paths:
    - $GRADLE_USER_HOME/caches/
    - $GRADLE_USER_HOME/wrapper/
    - $GRADLE_USER_HOME/build-cache/


build-jar:
  stage: build
  script: ./gradlew shadowJar
  artifacts:
    paths:
      - build/libs/

sonarqube:
  stage: codequality
  script: ./gradlew sonarqube -Dsonar.host.url=http://172.18.18.129

test:
  stage: test
  script: ./gradlew test

deploy:
  stage: deploy
  script: echo "TODO" 

